---
import { Picture } from 'astro:assets';
import ImgWhatsapp from '@assets/whatsapp-logo.png';
import { URLS } from '@constants/socials.ts';
const mensaje = '¡Hola! Quiero más información sobre El Hack.';
---

<a
   href={`https://api.whatsapp.com/send/?phone=${URLS.whatsapp.principal}&text=${encodeURIComponent(mensaje)}&type=phone_number&app_absent=0`}
   id="wa__stt"
   class="wa__stt inline-flex items-center gap-2 px-4 py-2 text-sm text-white bg-green-500 hover:bg-green-600 rounded-3xl transition"
   target="_blank"
   rel="noopener noreferrer"
>
   <Picture src={ImgWhatsapp} alt="Whatsapp" class="h-4 w-4 md:h-6 md:w-6" />
   <span>Contáctanos</span>
</a>

<script type="module">
   import { trackEvent, generateEventId } from '@utils/metaPixel.js';

   document.addEventListener('DOMContentLoaded', () => {
      const btn = document.getElementById('wa__stt');

      btn?.addEventListener('click', async () => {
         // Trackear con la API genérica y deduplicación automática
         await trackEvent(
            'Lead',
            {
               content_name: 'WhatsApp Contact',
               content_category: 'whatsapp_contact',
               lead_type: 'contact_button',
               page_url: window.location.href,
               page_title: document.title,
               value: 0,
               currency: 'MXN',
            },
            {},
         );

         // console.log('WhatsApp contact tracked with deduplication');
      });
   });
</script>
